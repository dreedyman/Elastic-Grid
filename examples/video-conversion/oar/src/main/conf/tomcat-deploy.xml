<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!--

    Copyright (C) 2007-2008 Elastic Grid, LLC.
    
    This file is part of Elastic Grid.
    
    Elastic Grid is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or any later version.
    
    Elastic Grid is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    
    You should have received a copy of the GNU Lesser General Public License
    along with Elastic Grid.  If not, see <http://www.gnu.org/licenses/>.

-->

<!DOCTYPE opstring PUBLIC "-/RIO//DTD" "http://www.rio-project.org/dtd/rio_opstring.dtd">
<opstring>

    <OperationalString Name="Tomcat Deploy">

        <Groups>
            <Group>rio</Group>
        </Groups>

        <ServiceExec Name="Tomcat">
            <SystemRequirements>
                <SystemComponent Name="SoftwareSupport">
                    <Attribute Name="Name" Value="Tomcat"/>
                    <Attribute Name="Version" Value="6.0.16"/>
                    <SoftwareLoad RemoveOnDestroy="yes">
                        <Download Source="apache-tomcat-6.0.16.zip"
                                  InstallRoot="${RIO_HOME}/system/external/tomcat"
                                  Unarchive="yes">
                            <Location>https://elastic-grid.s3.amazonaws.com/tomcat/</Location>
                        </Download>
                        <PostInstall RemoveOnCompletion="no">
                            <Exec nohup="no">
                                <CommandLine>/bin/chmod</CommandLine>
                                <InputArg>+x ${RIO_HOME}/system/external/tomcat/apache-tomcat-6.0.16/bin/*sh</InputArg>
                            </Exec>
                        </PostInstall>
                    </SoftwareLoad>
                </SystemComponent>
            </SystemRequirements>

            <Data Unarchive="yes" Perms="ugo+rwx">
                <FileName>sample.war</FileName>
                <Source>https://elastic-grid.s3.amazonaws.com/tomcat/</Source>
                <Target>${RIO_HOME}/system/external/tomcat/apache-tomcat-6.0.16/webapps</Target>
            </Data>

            <Exec>
                <WorkingDirectory>bin</WorkingDirectory>
                <CommandLine>catalina.sh</CommandLine>
                <InputArg>run</InputArg>
            </Exec>

            <Maintain>1</Maintain>

        </ServiceExec>

    </OperationalString>
</opstring>
